[{"categories":null,"content":"第一篇送给我从事的工作 Postgresql Kernel ","date":"10112-01-18","objectID":"/coding/pg%E5%86%85%E6%A0%B8/:0:1","tags":null,"title":"PG内核","uri":"/coding/pg%E5%86%85%E6%A0%B8/"},{"categories":null,"content":"Query Parse 根据用户的查询语句生成数据库中最优执行计划。 ","date":"10112-01-18","objectID":"/coding/pg%E5%86%85%E6%A0%B8/:1:0","tags":null,"title":"PG内核","uri":"/coding/pg%E5%86%85%E6%A0%B8/"},{"categories":null,"content":"Inroduction 命令类型 模块 简单命令(建表，创建用户，备份) 功能性命令处理 SELECT/INSERT/DELETE/UPDATE 查询树-\u003e查询重写-\u003e生成最优路径-\u003e执行计划 查询优化主要处理生成路径和生成计划。查询执行时，表连接开销最大。 阶段 模块 功能说明 源码路径 查询编译 查询分析 由SQL查询语句生成查询树 src/backend/parser 查询重写 对查询书重写并生成新的查询树以支持规则和视图 src/backend/rewrite 查询优化 生成路径 由查询树计算最优路径 src/backend/optimizer/path 生成计划 通过最优路径生成计划 src/backend/optimizer/plan 查询执行 执行计划 执行生成的计划 src/backend/executor 调度 将请求分配到合适的处理模块 src/backend/tcop 附件命令处理 处理建表,备份等命令 src/backend/commands ","date":"10112-01-18","objectID":"/coding/pg%E5%86%85%E6%A0%B8/:1:1","tags":null,"title":"PG内核","uri":"/coding/pg%E5%86%85%E6%A0%B8/"},{"categories":null,"content":"Query Analyze 用户输入的SQL命令——\u003e词法分析，语法分析—-\u003e分析树—-\u003e语义分析——-\u003e查询树 输入 功能模块 函数 输出 备注 exec_simple_query SQL命令 词法分析 pg_parse_query/pg_raw_parser 可在此处根据兼容性要求， 语法分析 pg_parse_query/pg_raw_parser 分析树 选择封装一层选择合适的解析器 语义分析 pg_analyze_and_rewrite parse_analyzer 查询树 Lex and Yacc 工具名称 功能 Lex 生成扫描器，其能识别模式如数字、字符串、特殊符号。 Yacc 生成语法分析器，识别模式的组合，即语法。 共同 生成用于词法分析和语法分析的源代码，使用符号表，通过yylval传递表示的值。 Lex 通过正则表示式进行模式识别。 Lex代码文件.l的基本结构 代码段 功能 定义 包含C语言头文件，符号说明，其代码会被拷贝到生成的扫描器代码中 规则 利用正则表达式来匹配模式，每当成功匹配一个模式，就对应气候的{}中的代码，这些匹配规则及动作都会反映到扫描器代码中 代码 可以是任意C代码，但是其中必须调用Lex提供的函数 其中各段由%%分隔 Lex函数 函数 作用 yylex 开始分析工作。由lex自动生成。 yywrap 在文件末尾调用。方法是使用yyin文件指针指向不同的文件。yywrap返回1表示解析结束 yyless 送回除了前n个字符外的所有读出标记 yymore 告诉Lexer将下一个标记附加到当前标记后 Lex变量 变量 作用 yyin FILE *类型。lexer正在解析的文件。 yyout FILE* 类型。指向lexer输出的位置。 yytext yyleng yylineno Yacc Lexical and Syntactic Analysis SELECT classno,classname, AVG(score) AS avg_score FROM sc, (SELECT * from class where class.gno = '2005') AS sub where sc.sno IN (select sno FROM student FROM student WHRER student.classno = sub.classno) AND sc.cno IN (SELECT course.cno FROM course WHERE course.cname = '高等数学') GROUP BY classno, classname HAVING AVG(score) \u003e 80.0 ORDER BY avg_score; Example Statemet DISTINCT Clause TARGET ATTRIBUTE FROM CLAUSE WHERE CLAUSE GROUP BY CLAUSE HAVING CLAUSE AND ORDER BY CLAUSE Semantic Analysis 函数 功能 层级 输入 输出 exec_simple_query 对每颗分析树调用pg_analyze_and_rewrite 1 parsetreelist pg_analyze_and_rewrite 语义分析和查询重写 2 单棵分析数 查询树链表 parse_analyze 语义分析 3 单棵分析数 单棵查询树 pg_rewrite_query 查询重写 3 单棵查询树 查询树链表 Query Struct Type name comment NodeTag type 节点类型，T_Query CmdType commandType 命令类型 QuerySource querySource 是原始查询还是来自于规则的查询 bool canSetTag 查询重写时用到，如果该Query是由原始查询转换为来则此字段为假，如果Query是由查询重写或查询规划时新增加的则此字段为真 Node* utilityStmt 定义游标或者不可优化的查询语句 int resultRelation 结果关系 IntoClause* intoClause 处理SELECT INTO和CREATE TABLE AS的信息 bool hasAggs bool hasWindowFuncs bool hasSubLinks bool hasDistincton bool hasRecursive List* cteList List* rtable FromExpr* jointree 连接树，描述FROM和WHERE子句出现的连接 List* targetList List* returningList List* groupClause Node* havingQual List* windowClause List* sortClause List* distinctClause List* sortClause List* limitOffset List* limitCount List* rowMarks Node* setOperations ","date":"10112-01-18","objectID":"/coding/pg%E5%86%85%E6%A0%B8/:1:2","tags":null,"title":"PG内核","uri":"/coding/pg%E5%86%85%E6%A0%B8/"},{"categories":null,"content":"Query Execution ","date":"10112-01-18","objectID":"/coding/pg%E5%86%85%E6%A0%B8/:2:0","tags":null,"title":"PG内核","uri":"/coding/pg%E5%86%85%E6%A0%B8/"},{"categories":null,"content":"Plan Node Scan Node SeqScanNode ","date":"10112-01-18","objectID":"/coding/pg%E5%86%85%E6%A0%B8/:2:1","tags":null,"title":"PG内核","uri":"/coding/pg%E5%86%85%E6%A0%B8/"},{"categories":null,"content":"一份未完成的自我介绍 骑驴走马 ","date":"10112-01-18","objectID":"/about/%E5%85%B3%E4%BA%8E%E6%88%91/:0:1","tags":null,"title":"关于我","uri":"/about/%E5%85%B3%E4%BA%8E%E6%88%91/"},{"categories":null,"content":"前言 很难说出于一种什么样的心情和目的想要去做一个自己的博客，无论是记录自己的生活还是与他人分享，都算是当下的一种目的，更多地可能是想要发出一点自己的声音能让世界听到，无论是否会被浪花淹没，也许能找到同路人，也算是一种惊喜。 ","date":"10112-01-18","objectID":"/life/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/:0:1","tags":null,"title":"我的第一篇博客","uri":"/life/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"},{"categories":null,"content":"关于我想记录的东西 编程 关于自己的生活应该是被工作和生活里的一些琐碎填满的，而工作又是编程相关的东西，本职工作是做一些数据库内核开发，但又不甘于只关注当下，所以就把编程单独拎了出来，不仅记录些数据库内核学到的知识，也会记录一些新掌握的编程技能。 生活 至于剩下的生活部分，其实现在也开始慢慢对生活中很多的东西做一些总结和记录，发现其实也能帮助到一些身边的人，所以就也会分享下生活中一些实用或者有趣的想法。 思索 最后的最后就是，我来源于生活又高于它们的一些东西了，对于自我和世界的一些思考，当然局限于自己的阅历与眼界，权当抛砖引玉，博君一笑，若有共鸣，不妨探讨。 ","date":"10112-01-18","objectID":"/life/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/:0:2","tags":null,"title":"我的第一篇博客","uri":"/life/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"},{"categories":null,"content":"一份关于自我与世界的思考 在这里很难交出一份令自己满意的答卷，不论是自己所学，还是自己所思，目前为止都很难准确地将客观的或者主观的部分描述清楚。 ","date":"10112-01-18","objectID":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/:0:0","tags":null,"title":"自我与世界","uri":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/"},{"categories":null,"content":"分类 我只能清晰地将所认知的存在划分为两个部分，世界和自我，就我目前所浅显了解到的哲学回答的问题，也大致与此相关，当然我对哲学的向往仅仅止于我知道它能帮助我解惑，但其中艰难晦涩往往使我寸步不前。 继续回到这两个分类，对于我而言，我无法摆脱人类的身体以及它所塑造的精神世界，因此探讨自我是一个无法回避的问题，而人类的生存又与周遭的环境息息相关，对于史前人类来说，生存仅需与周围方圆几里的环境进行搏斗，终其一生的世界之所知所得无非是如何获取食物与水，躲避灾害，天空与大地的深处仅仅是远观的世界景观，与它们的生活无法发生任何交集，而慢慢地，随着时间的推移，人类对世界的认识也越发广博，随着人类群体的壮大，人类群体，个体之间的关系也变得更加复杂，逐渐衍生出的人文学科，也就是所谓的经济，政治这一系列学问。 除了人类内部之间的变化，人类对世界的认识也在逐渐深刻，得益于人类的好奇心以及从探索中受益的正反馈，人类从经验中总结出的工程学问一步步上升到科学的高度，到最后也就是我们非常熟悉的数学，物理，化学，生物，地理种种学科。总而言之，我们是在用自己的语言去描述这个世界，无论是公理还是假设，都是对客观真相的某种刻画。 ","date":"10112-01-18","objectID":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/:1:0","tags":null,"title":"自我与世界","uri":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/"},{"categories":null,"content":"自我 自我是一个非常难以探讨的话题，除了个体个性而言，还有人类的共性，究其我所受的物质决定精神的教育以及实践，我觉得这个探讨范围除了精神世界也包含人的身体，这种讨论不局限个性，也包含人类的共性。也因此得益于我之前了解关于狗的书时所得来的经验，研究人类即是人类的外形，人类的构造，人类的行为，人类的情绪，将它们交叉起来应该就能得到我们想要答案的全貌。 至于想了解这些答案，我给自己的方向是： 生活中的观察与实践（自我或他人） 人类学 心理学 医学（无论中医） 除此之外，为什么将自我放在最前面是因为我觉得人类认识世界其实也是为了满足自我的某种需求，归根到底是回到自我。 ","date":"10112-01-18","objectID":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/:1:1","tags":null,"title":"自我与世界","uri":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/"},{"categories":null,"content":"世界 世界太浩瀚了，但世界也很渺小活在我们对世界不客观的描述中，其实虚假错误无碍我们的生活时，我们从来不在乎真相。但至少现在，认识世界还是能满足我不少的好奇心，解决我生活中遇到不少的问题，至于对于世界的认识，很惨的是，我现在除了将其按需要关注的重点分为人类世界和自然世界，自然世界分为自然法则和依赖其生存的物质和生命体之外仍无法将其准确地切割，所以先与这个世界亲密接触，以后再来给自己一个答案吧。 顺便一提，接触到的一种描述世界很有意思的一种方式，算命，感觉本质上就是数的应用，难道这个宇宙中某些数字就像参数一样能揭示当下命运的走向么？不过所学颇浅，以后另说。 ","date":"10112-01-18","objectID":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/:1:2","tags":null,"title":"自我与世界","uri":"/reflection/%E8%87%AA%E6%88%91%E4%B8%8E%E4%B8%96%E7%95%8C/"}]